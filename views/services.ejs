<style>
    /* 1. HERO GRADIENT */
    @keyframes gradient-xy {
        0%, 100% { background-position: 0% 50%; }
        50% { background-position: 100% 50%; }
    }
    .animate-gradient { background-size: 200% 200%; animation: gradient-xy 15s ease infinite; }
    
    /* 2. SLOW PAN/ZOOM FOR HERO IMAGE */
    @keyframes pan-image {
        0% { transform: scale(1); }
        50% { transform: scale(1.1); }
        100% { transform: scale(1); }
    }
    .animate-pan { animation: pan-image 20s ease-in-out infinite; }

    /* 3. FLOATING BLOBS */
    @keyframes float {
        0% { transform: translate(0px, 0px); }
        33% { transform: translate(30px, -50px); }
        66% { transform: translate(-20px, 20px); }
        100% { transform: translate(0px, 0px); }
    }
    .animate-blob { animation: float 10s infinite ease-in-out; }

    /* 4. BUTTON SHINE */
    @keyframes shine {
        100% { left: 125%; }
    }
    .btn-shine { position: relative; overflow: hidden; }
    .btn-shine::after {
        content: ''; position: absolute; top: 0; left: -100%; width: 100%; height: 100%;
        background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
        transition: 0.5s;
    }
    .btn-shine:hover::after { animation: shine 1s; }

    /* 5. SMOOTH REVEAL */
    .reveal { opacity: 0; transform: translateY(40px); transition: all 1.2s cubic-bezier(0.16, 1, 0.3, 1); }
    .reveal.active { opacity: 1; transform: translateY(0); }
</style>

<div id="preloader" class="fixed inset-0 z-[9999] bg-slate-950 flex flex-col items-center justify-center transition-opacity duration-700 ease-out">
    <div class="relative w-24 h-24 mb-6">
        <div class="absolute inset-0 border-t-4 border-cyan-500 rounded-full animate-spin"></div>
        <div class="absolute inset-3 border-b-4 border-white/20 rounded-full animate-spin" style="animation-direction: reverse; animation-duration: 2s;"></div>
    </div>
</div>

<div class="relative h-[60vh] flex items-center justify-center overflow-hidden bg-slate-900">
    <div class="absolute inset-0 bg-gradient-to-br from-slate-900 via-cyan-950 to-slate-900 animate-gradient opacity-90 z-10"></div>
    
    <div class="absolute inset-0 z-0 overflow-hidden">
        <div class="w-full h-full bg-[url('https://images.unsplash.com/photo-1600334019640-eb89d892d3f6?q=80&w=1920&auto=format&fit=crop')] bg-cover bg-center opacity-40 mix-blend-overlay animate-pan"></div>
    </div>
    
    <div class="relative z-20 text-center px-4 max-w-4xl mx-auto pt-20">
        <span class="inline-block py-1 px-3 rounded-full bg-cyan-500/10 border border-cyan-500/20 text-cyan-300 text-xs font-bold tracking-[0.3em] uppercase mb-6 reveal">
            Curated Wellness
        </span>
        <h1 class="text-5xl md:text-7xl font-black text-white mb-6 reveal" style="transition-delay: 100ms;">
            Our Therapies
        </h1>
        <p class="text-lg text-slate-300 max-w-2xl mx-auto font-light leading-relaxed reveal" style="transition-delay: 200ms;">
            Choose from our selection of premium recovery protocols designed to reset your nervous system and optimize your physiology.
        </p>
    </div>
</div>

<section class="py-24 bg-slate-50 relative overflow-hidden">
    <div class="absolute top-0 left-0 w-96 h-96 bg-cyan-200/20 rounded-full blur-[100px] animate-blob"></div>
    <div class="absolute bottom-0 right-0 w-96 h-96 bg-blue-200/20 rounded-full blur-[100px] animate-blob" style="animation-delay: 2s;"></div>
    <div class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[800px] h-[800px] bg-slate-100/50 rounded-full blur-[120px] pointer-events-none"></div>

    <div class="max-w-7xl mx-auto px-4 relative z-10">
        
        <% if (services.length === 0) { %>
            <div class="text-center py-20 reveal">
                <h3 class="text-2xl font-bold text-slate-400">No therapies available at the moment.</h3>
                <p class="text-slate-500 mt-2">Please check back later or contact us.</p>
            </div>
        <% } %>

        <div class="grid md:grid-cols-3 gap-10">
            <% services.forEach((service, index) => { %>
                <div class="group bg-white rounded-[2rem] shadow-xl hover:shadow-2xl hover:shadow-cyan-500/20 overflow-hidden transition-all duration-500 hover:-translate-y-3 hover:rotate-1 reveal flex flex-col h-full border border-slate-100 relative" style="transition-delay: <%= index * 100 %>ms;">
                    
                    <div class="h-72 overflow-hidden relative">
                        <img src="<%= service.imageURL %>" class="w-full h-full object-cover group-hover:scale-110 transition duration-1000 ease-out">
                        
                        <div class="absolute inset-0 bg-gradient-to-t from-slate-900/90 via-transparent to-transparent opacity-60 group-hover:opacity-40 transition-opacity"></div>

                        <% if(service.discountPercent > 0) { %>
                            <div class="absolute top-4 right-4 bg-red-500 text-white text-[10px] font-bold px-3 py-1.5 rounded-full z-10 shadow-lg tracking-widest uppercase animate-pulse">
                                Save <%= service.discountPercent %>%
                            </div>
                        <% } %>

                        <div class="absolute top-4 left-4 bg-white/20 backdrop-blur-md border border-white/20 text-white text-[10px] font-bold px-3 py-1.5 rounded-full z-10 tracking-widest uppercase shadow-sm">
                            <%= service.category %>
                        </div>
                    </div>
                    
                    <div class="p-8 flex flex-col flex-grow relative bg-white">
                        <div class="mb-4">
                            <h2 class="text-2xl font-bold text-slate-900 group-hover:text-cyan-700 transition-colors duration-300 font-serif mb-2">
                                <%= service.title %>
                            </h2>
                            <div class="h-1 w-12 bg-cyan-500 rounded-full mb-4 group-hover:w-24 transition-all duration-500"></div>
                            
                            <p class="text-slate-500 text-sm leading-relaxed line-clamp-3">
                                <%= service.description || 'Experience the ultimate recovery session designed to boost your immunity and mental clarity.' %>
                            </p>
                        </div>

                        <div class="mt-auto pt-6 border-t border-slate-100 flex items-center justify-between">
                            <div>
                                <% if(service.discountPercent > 0) { %>
                                    <div class="flex flex-col">
                                        <span class="text-xs text-slate-400 line-through decoration-red-400">₹<%= service.price %></span>
                                        <span class="text-3xl font-black text-slate-900 tracking-tight">₹<%= service.discountPrice %></span>
                                    </div>
                                <% } else { %>
                                    <span class="text-3xl font-black text-slate-900 tracking-tight">₹<%= service.price %></span>
                                <% } %>
                                <span class="text-xs text-cyan-600 font-bold uppercase tracking-wider mt-1 block group-hover:text-cyan-500 transition-colors"><%= service.duration %> Session</span>
                            </div>

                            <a href="/book?service=<%= service._id %>" class="btn-shine bg-slate-900 text-white px-8 py-4 rounded-xl font-bold text-sm hover:bg-cyan-600 transition-all duration-300 shadow-lg hover:shadow-cyan-500/40 transform active:scale-95 group-hover:-translate-y-1">
                                Book Now
                            </a>
                        </div>
                    </div>
                </div>
                <% }) %>
        </div>
    </div>
</section>

<script>
    // 1. LOADER LOGIC
    window.addEventListener('load', () => {
        const preloader = document.getElementById('preloader');
        if(preloader) {
            setTimeout(() => { preloader.style.opacity = '0'; setTimeout(() => preloader.style.display = 'none', 700); }, 500);
        }
    });

    // 2. SCROLL REVEAL
    const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => { 
            if (entry.isIntersecting) {
                entry.target.classList.add('active'); 
            }
        });
    }, { threshold: 0.1 });
    
    document.querySelectorAll('.reveal').forEach(el => observer.observe(el));
</script>
